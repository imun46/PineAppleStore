<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<<<<<<< HEAD
	<!-- 리뷰 작성 -->
	<insert id="insert"
		parameterType="com.itwill.shop.review.Review">
		<selectKey order="BEFORE" resultType="int"
			keyProperty="reviewNo"> select review_review_no_seq.nextval from dual;</selectKey>
		INSERT INTO review (review_no, product_no, review_title,
		review_content, review_image, review_rating, customer_no)
		VALUES(
		#{reviewNo},
		#{productNo},
		#{reviewTitle},
		#{reviewContent},
		#{reviewImage},
		#{reviewRating},
		#{customerNo})
	</insert>
	<!-- 리뷰 수정 -->
	<update id="update" parameterType="Review">
		update review set
		review_title= #{reviewTitle},
		review_content=#{reviewContent},
		review_image=#{reviewImage},
		review_rating=#{reviewRating} 
		where product_no=#{productNo}
		and customer_no=#{customerNo}
	</update>
	<!-- 리뷰 삭제 -->
	<delete id="delete" parameterType="int">
		delete from review where
		product_no=#{productNo} 
		and customer_no=#{customerNo}
	</delete>
	<!-- 리뷰리스트(회원) -->
	<select id="findMyReview" parameterType ="int" resultType="Review">
		select * from review where product_no=#{productNo}
	</select>
	<!-- 리뷰리스트(상품) -->
	<select id="findProductReview" parameterType ="int" resultType="Review">
		select * from review where customer_no=#{customerNo}
	
	</select>
	
	<!-- 리뷰 한개 보기 -->
	<select id="findByReview" parameterType="int" resultType="Review">
		select * from review where review_no =#{reviewNo};
=======
<!--  dto 멤버 변수 이름이랑 id 콜럼에 있는 프로퍼티 이름이랑 다르게 하기 -->
<mapper namespace="com.itwill.shop.mapper.ReviewMapper">
	 <resultMap id="reviewResultMap" type="Review" autoMapping="true">
        <id column="review_no" property="reviewNo" />
        <association property="product" javaType="Product" autoMapping="true">
            <id column="product_no" property="productNo" />
        </association>
        <association property="customer" javaType="Customer" autoMapping="true">
            <id column="customer_no" property="customerNo" />
            <!-- 필요에 따라 다른 필드도 추가 -->
        </association>
    </resultMap>
	
	<!-- 리뷰 작성 -->
	<insert id="insert"
		parameterType="com.itwill.shop.review.Review">
		<selectKey order="BEFORE" resultType="int"
			keyProperty="reviewNo"> select review_review_no_seq.nextval from dual</selectKey>
		INSERT INTO review (review_no, product_no, review_title,
		review_content, review_image, review_rating, customer_no)
		VALUES(
		#{reviewNo},
		#{product.productNo},
		#{reviewTitle},
		#{reviewContent},
		#{reviewImage},
		#{reviewRating},
		#{customer.customerNo})
	</insert>
	
	<!-- 리뷰 수정 -->
	<update id="update" parameterType="Review">
		update review set
		review_title= #{reviewTitle},
		review_content=#{reviewContent},
		review_image=#{reviewImage},
		review_rating=#{reviewRating},
		product_no=#{product.productNo},
		customer_no=#{customer.customerNo}
		where review_no=#{reviewNo}
		
	</update>
	
	<!-- 리뷰 삭제 -->
	<delete id="delete" parameterType="int">
		delete from review
		where review_no=#{reviewNo}
	</delete>
	
	<!-- 리뷰리스트(회원) -->
	<select id="findMyReview" parameterType ="int" resultType="Review">
		select * from review where product_no=#{productNo}
	</select>
	
	<!-- 리뷰리스트(상품) -->
	<select id="findProductReview" parameterType ="int" resultType="Review">
		select * from review where customer_no=#{customerNo}
	
	</select>
	
	<!-- 리뷰 한개 보기 -->
	<select id="findByReview" parameterType="Integer" resultMap="reviewResultMap">
		select * from review where review_no =#{reviewNo}
>>>>>>> refs/heads/Bteam/customer
	</select>
</mapper>